---
title: Insert Delete GetRandom O(1)
category: Arrays And Hashing
difficulty: Medium
---

<Callout>

[Leetcode Link](https://leetcode.com/problems/insert-delete-getrandom-o1)

</Callout>

## Description

Implement the <code>RandomizedSet</code> class:

    - <code>RandomizedSet()</code> Initializes the <code>RandomizedSet</code> object.
    - <code>bool insert(int val)</code> Inserts an item <code>val</code> into the set if not present. Returns <code>true</code> if the item was not present, <code>false</code> otherwise.
    - <code>bool remove(int val)</code> Removes an item <code>val</code> from the set if present. Returns <code>true</code> if the item was present, <code>false</code> otherwise.
    - <code>int getRandom()</code> Returns a random element from the current set of elements (it&#39;s guaranteed that at least one element exists when this method is called). Each element must have the <b>same probability</b> of being returned.

You must implement the functions of the class such that each function works in average <code>O(1)</code> time complexity.

Example 1:

<br />

<pre className="overflow-x-auto">
	Input [&quot;RandomizedSet&quot;, &quot;insert&quot;, &quot;remove&quot;,
	&quot;insert&quot;, &quot;getRandom&quot;, &quot;remove&quot;,
	&quot;insert&quot;, &quot;getRandom&quot;] [[], [1], [2], [2], [], [1], [2],
	[]] Output [null, true, false, true, 2, true, false, 2] Explanation
	RandomizedSet randomizedSet = new RandomizedSet(); randomizedSet.insert(1); //
	Inserts 1 to the set. Returns true as 1 was inserted successfully.
	randomizedSet.remove(2); // Returns false as 2 does not exist in the set.
	randomizedSet.insert(2); // Inserts 2 to the set, returns true. Set now
	contains [1,2]. randomizedSet.getRandom(); // getRandom() should return either
	1 or 2 randomly. randomizedSet.remove(1); // Removes 1 from the set, returns
	true. Set now contains [2]. randomizedSet.insert(2); // 2 was already in the
	set, so return false. randomizedSet.getRandom(); // Since 2 is the only number
	in the set, getRandom() will always return 2.
</pre>

Constraints:

    - <code>-2<sup>31</sup> &lt;= val &lt;= 2<sup>31</sup> - 1</code>
    - At most <code>2 * </code><code>10<sup>5</sup></code> calls will be made to <code>insert</code>, <code>remove</code>, and <code>getRandom</code>.
    - There will be at least one element in the data structure when <code>getRandom</code> is called.

## Solution

### Javascript

```javascript
var RandomizedSet = function () {
	this.set = new Set()
}

/**
 * @param {number} val
 * @return {boolean}
 */
RandomizedSet.prototype.insert = function (val) {
	const res = !this.set.has(val)
	if (res) {
		this.set.add(val)
	}
	return res
}

/**
 * @param {number} val
 * @return {boolean}
 */
RandomizedSet.prototype.remove = function (val) {
	return this.set.delete(val)
}

/**
 * @return {number}
 */
RandomizedSet.prototype.getRandom = function () {
	const keys = Array.from(this.set.keys())
	const seed = Math.floor(Math.random() * keys.length)
	return keys[seed]
}

/**
 * Your RandomizedSet object will be instantiated and called as such:
 * var obj = new RandomizedSet()
 * var param_1 = obj.insert(val)
 * var param_2 = obj.remove(val)
 * var param_3 = obj.getRandom()
 */
```

### Python

```python
from random import choice


class RandomizedSet:

    def __init__(self):
        self.dict = {}
        self.list = []

    def insert(self, val: int) -> bool:
        if val in self.dict:
            return False

        self.dict[val] = len(self.list)
        self.list.append(val)

        return True

    def remove(self, val: int) -> bool:
        if val not in self.dict:
            return False

        idx, last_element = self.dict[val], self.list[-1]
        self.list[idx], self.dict[last_element] = last_element, idx
        self.list.pop()
        del self.dict[val]

        return True

    def getRandom(self) -> int:
        return choice(self.list)

```

### C++

```cpp
class RandomizedSet {
public:

    unordered_map<int,int> indices;
    vector<int> values;
    RandomizedSet() {
    }

    bool insert(int val) {

        if(indices.find(val)==indices.end()){
            values.push_back(val);
            // store the index of that value
            indices[val] = values.size() -1;
            return true;
        }
        return false;
    }

    bool remove(int val) {

       if(indices.find(val)==indices.end()){
           return false;
       }

        // find index of the value
        int idx = indices[val];
        // get the last value in the vector
        // and change its index to curr val's index
        indices[values[values.size()-1]] = idx;

        // replace curr vals index with last
        // last value
        values[idx] = values[values.size()-1];

        // so now the curr val is removed from the
        // vector replaced by last value and so
        // we could just remove last value
        values.pop_back();

        // also erase it from the hash map
        indices.erase(val);
        return true;
    }

    int getRandom() {
        return values[rand()%values.size()];
    }
};

/**
 * Your RandomizedSet object will be instantiated and called as such:
 * RandomizedSet* obj = new RandomizedSet();
 * bool param_1 = obj->insert(val);
 * bool param_2 = obj->remove(val);
 * int param_3 = obj->getRandom();
 */
```

### Java

```java
class RandomizedSet {
    private Map<Integer, Integer> indexing;
    private List<Integer> numbers;

    public RandomizedSet() {
        this.indexing = new HashMap<>();
        this.numbers = new ArrayList<>();
    }

    // Append to the end, maintain indexing
    // Delete by swapping with the end, maintain indexing
    // Get random by getting a random index wrt list's size

    public boolean insert(int val) {
        if(this.indexing.containsKey(val)) {
            return false;
        }
        int indexInsert = this.numbers.size();
        this.numbers.add(val);
        this.indexing.put(val, indexInsert);
        return true;
    }

    public boolean remove(int val) {
        if(!this.indexing.containsKey(val)) {
            return false;
        }

        int lastIndex = this.numbers.size() - 1;
        int lastElement = this.numbers.get(lastIndex);
        int indexElement = this.indexing.get(val);

        // Swap with last element
        this.numbers.set(indexElement, lastElement);

        // Update indices [Add & Delete]
        this.indexing.put(lastElement, indexElement);
        this.indexing.remove(val);

        // Remove from list
        this.numbers.remove(lastIndex);
        return true;
    }

    public int getRandom() {
        int randomIndex = (int) (Math.random() * this.numbers.size());
        return this.numbers.get(randomIndex);
    }
}

/**
 * Your RandomizedSet object will be instantiated and called as such:
 * RandomizedSet obj = new RandomizedSet();
 * boolean param_1 = obj.insert(val);
 * boolean param_2 = obj.remove(val);
 * int param_3 = obj.getRandom();
 */
```
